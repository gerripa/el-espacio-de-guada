<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Espacio Personal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Montserrat:wght@300;400&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --cream: #f5f1eb;
            --cream-dark: #e8dfd3;
            --gold: #8b6f47;
            --gold-dark: #6d5938;
            --brown: #5c4a3a;
            --text-dark: #3a3a3a;
            --text-light: #6a6a6a;
            --shadow: rgba(92, 74, 58, 0.15);
        }
        
        body.dark-mode {
            --cream: #2a2520;
            --cream-dark: #3a342e;
            --gold: #a08870;
            --gold-dark: #8b6f47;
            --brown: #6d5938;
            --text-dark: #e8dfd3;
            --text-light: #c9bcb0;
            --shadow: rgba(0, 0, 0, 0.4);
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--cream);
            color: var(--text-dark);
            line-height: 1.7;
            transition: all 0.4s ease;
            letter-spacing: 0.3px;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        header {
            text-align: center;
            padding: 80px 30px 60px;
            background: linear-gradient(180deg, var(--cream-dark) 0%, var(--cream) 100%);
            margin-bottom: 50px;
            position: relative;
            border-radius: 0 0 50px 50px;
        }
        
        header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 1px;
            background: var(--gold);
        }
        
        h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.8em;
            font-weight: 300;
            color: var(--gold);
            margin-bottom: 20px;
            letter-spacing: 4px;
            text-transform: uppercase;
        }
        
        .quote {
            font-family: 'Cormorant Garamond', serif;
            font-style: italic;
            color: var(--text-light);
            font-size: 1.05em;
            margin-top: 20px;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        .mode-toggle {
            position: fixed;
            top: 30px;
            right: 30px;
            background: var(--cream-dark);
            border: 1px solid var(--gold);
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 2px 15px var(--shadow);
        }
        
        .mode-toggle:hover {
            background: var(--gold);
            transform: translateY(-2px);
        }
        
        nav {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin-bottom: 50px;
            flex-wrap: wrap;
            border-bottom: 1px solid var(--gold);
            padding-bottom: 2px;
        }
        
        .nav-btn {
            font-family: 'Montserrat', sans-serif;
            background: transparent;
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85em;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 300;
            position: relative;
        }
        
        .nav-btn::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background: var(--gold);
            transition: width 0.3s ease;
        }
        
        .nav-btn:hover::after, .nav-btn.active::after {
            width: 80%;
        }
        
        .nav-btn.active {
            color: var(--gold);
        }
        
        .section {
            display: none;
            animation: fadeIn 0.6s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .card {
            background: var(--cream-dark);
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 5px 30px var(--shadow);
            transition: all 0.3s ease;
            border: 1px solid rgba(139, 111, 71, 0.2);
            border-radius: 25px;
        }
        
        .card:hover {
            box-shadow: 0 8px 40px var(--shadow);
        }
        
        h2 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2em;
            color: var(--gold);
            margin-bottom: 25px;
            font-weight: 400;
            letter-spacing: 2px;
            text-align: center;
            text-transform: uppercase;
        }
        
        h3 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4em;
            color: var(--brown);
            margin: 25px 0 15px 0;
            font-weight: 400;
            letter-spacing: 1px;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px 20px;
            margin: 12px 0;
            border: 1px solid var(--gold);
            background: var(--cream);
            color: var(--text-dark);
            transition: all 0.3s ease;
            font-size: 0.9em;
            font-family: 'Montserrat', sans-serif;
            font-weight: 300;
            border-radius: 20px;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--gold-dark);
            box-shadow: 0 0 0 2px rgba(139, 111, 71, 0.1);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }
        
        button {
            background: var(--gold);
            color: white;
            border: none;
            padding: 14px 35px;
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.85em;
            transition: all 0.3s ease;
            margin: 8px 5px;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 400;
            border-radius: 25px;
        }
        
        button:hover {
            background: var(--gold-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px var(--shadow);
        }
        
        .day-section {
            background: var(--cream);
            padding: 25px;
            margin: 25px 0;
            border-left: 2px solid var(--gold);
            border-radius: 20px;
        }
        
        .day-header {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.3em;
            color: var(--gold);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            letter-spacing: 1px;
        }
        
        .note-item {
            background: var(--cream-dark);
            padding: 18px;
            margin: 12px 0;
            border-left: 1px solid var(--gold);
            border-radius: 15px;
        }
        
        .note-time {
            color: var(--text-light);
            font-size: 0.8em;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }
        
        .delete-btn {
            background: var(--brown);
        }
        
        .delete-btn:hover {
            background: #6a5a45;
        }
        
        .song-item, .reminder-item, .task-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px;
            background: var(--cream);
            margin: 12px 0;
            transition: all 0.3s ease;
            border-left: 1px solid var(--gold);
            border-radius: 20px;
        }
        
        .song-item:hover, .reminder-item:hover, .task-item:hover {
            background: var(--cream-dark);
            border-left-width: 3px;
        }
        
        .reminder-item.completed, .task-item.completed {
            opacity: 0.5;
        }
        
        .reminder-item.completed .reminder-text,
        .task-item.completed .task-text {
            text-decoration: line-through;
        }
        
        .checkbox {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
            accent-color: var(--gold);
        }
        
        .item-content {
            flex: 1;
            font-size: 0.95em;
        }
        
        .item-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .file-upload-area {
            border: 1px dashed var(--gold);
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
            background: var(--cream);
            color: var(--text-light);
            font-size: 0.9em;
            letter-spacing: 0.5px;
            border-radius: 20px;
        }
        
        .file-upload-area:hover {
            border-color: var(--gold-dark);
            background: var(--cream-dark);
        }
        
        .file-item {
            background: var(--cream);
            padding: 12px 18px;
            margin: 10px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9em;
            border-radius: 15px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: var(--cream);
            padding: 30px;
            text-align: center;
            border: 1px solid var(--gold);
            border-radius: 20px;
        }
        
        .stat-number {
            font-family: 'Cormorant Garamond', serif;
            font-size: 3em;
            color: var(--gold);
            font-weight: 300;
        }
        
        .stat-label {
            color: var(--text-light);
            margin-top: 8px;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .mood-selector {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .mood-btn {
            font-size: 2em;
            background: var(--cream);
            border: 1px solid var(--gold);
            border-radius: 50%;
            padding: 18px 22px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .mood-btn:hover, .mood-btn.selected {
            transform: scale(1.15);
            border-color: var(--gold-dark);
            box-shadow: 0 5px 20px var(--shadow);
        }
        
        .goals-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }
        
        .goal-card {
            background: var(--cream);
            padding: 25px;
            border-left: 2px solid var(--gold);
            border-radius: 20px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--cream-dark);
            overflow: hidden;
            margin: 15px 0;
            border-radius: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gold);
            transition: width 0.3s ease;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
                letter-spacing: 2px;
            }
            
            header {
                padding: 60px 20px 40px;
            }
            
            .stats-grid, .goals-container {
                grid-template-columns: 1fr;
            }
            
            .song-item, .reminder-item, .task-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .item-actions {
                width: 100%;
                margin-top: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="mode-toggle" onclick="toggleDarkMode()">🌙</div>
    
    <header>
        <h1>Personal Space</h1>
        <div class="quote" id="dailyQuote"></div>
    </header>
    
    <div class="container">
        <nav>
            <button class="nav-btn active" onclick="showSection('home')">Home</button>
            <button class="nav-btn" onclick="showSection('journal')">Journal</button>
            <button class="nav-btn" onclick="showSection('songs')">Music</button>
            <button class="nav-btn" onclick="showSection('reminders')">Reminders</button>
            <button class="nav-btn" onclick="showSection('faculty')">University</button>
            <button class="nav-btn" onclick="showSection('goals')">Goals</button>
            <button class="nav-btn" onclick="showSection('photos')">Memories</button>
        </nav>
        
        <!-- HOME SECTION -->
        <div id="home" class="section active">
            <div class="card">
                <h2>Welcome</h2>
                <p style="text-align: center; margin: 20px 0; color: var(--text-light); letter-spacing: 0.5px;" id="todayDate"></p>
                
                <h3>How are you feeling today?</h3>
                <div class="mood-selector">
                    <button class="mood-btn" onclick="saveMood('😊')" title="Happy">😊</button>
                    <button class="mood-btn" onclick="saveMood('😌')" title="Calm">😌</button>
                    <button class="mood-btn" onclick="saveMood('😔')" title="Sad">😔</button>
                    <button class="mood-btn" onclick="saveMood('😤')" title="Angry">😤</button>
                    <button class="mood-btn" onclick="saveMood('😴')" title="Tired">😴</button>
                    <button class="mood-btn" onclick="saveMood('🤗')" title="Excited">🤗</button>
                </div>
                <div id="moodHistory" style="margin-top: 25px;"></div>
            </div>
            
            <div class="card">
                <h2>Today's Summary</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="statNotes">0</div>
                        <div class="stat-label">Notes Written</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statTasks">0</div>
                        <div class="stat-label">Pending Tasks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statGoals">0</div>
                        <div class="stat-label">Active Goals</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="statDays">0</div>
                        <div class="stat-label">Days Recorded</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- JOURNAL SECTION -->
        <div id="journal" class="section">
            <div class="card">
                <h2>Personal Journal</h2>
                <textarea id="journalText" placeholder="What happened today? How do you feel?"></textarea>
                <button onclick="addJournalNote()">Save Note</button>
            </div>
            <div id="journalDays"></div>
        </div>
        
        <!-- SONGS SECTION -->
        <div id="songs" class="section">
            <div class="card">
                <h2>Music Collection</h2>
                <input type="text" id="songName" placeholder="Song name">
                <input type="text" id="songArtist" placeholder="Artist">
                <input type="url" id="songLink" placeholder="Link (Spotify/YouTube)">
                <button onclick="addSong()">Add Song</button>
            </div>
            <div id="songsList"></div>
        </div>
        
        <!-- REMINDERS SECTION -->
        <div id="reminders" class="section">
            <div class="card">
                <h2>Personal Reminders</h2>
                <input type="text" id="reminderText" placeholder="What do you need to remember?">
                <input type="date" id="reminderDate">
                <button onclick="addReminder()">Add Reminder</button>
            </div>
            <div id="remindersList"></div>
        </div>
        
        <!-- FACULTY SECTION -->
        <div id="faculty" class="section">
            <div class="card">
                <h2>University Tasks</h2>
                <input type="text" id="taskSubject" placeholder="Subject">
                <textarea id="taskDescription" placeholder="What do you need to do? (e.g., Read chapter 3, complete assignment)"></textarea>
                <input type="date" id="taskDate" placeholder="Due date">
                <div class="file-upload-area" onclick="document.getElementById('taskFile').click()">
                    Click to attach files (PDF, Word, images, etc.)
                </div>
                <input type="file" id="taskFile" style="display:none" multiple>
                <div id="taskFilesList"></div>
                <select id="taskPriority">
                    <option value="baja">Low Priority</option>
                    <option value="media">Medium Priority</option>
                    <option value="alta">High Priority</option>
                </select>
                <button onclick="addTask()">Add Task</button>
            </div>
            <div id="tasksList"></div>
        </div>
        
        <!-- GOALS SECTION -->
        <div id="goals" class="section">
            <div class="card">
                <h2>Personal Goals</h2>
                <input type="text" id="goalTitle" placeholder="What do you want to achieve?">
                <textarea id="goalDescription" placeholder="Describe your goal..."></textarea>
                <input type="date" id="goalDeadline" placeholder="Deadline">
                <button onclick="addGoal()">Create Goal</button>
            </div>
            <div class="goals-container" id="goalsList"></div>
        </div>
        
        <!-- PHOTOS SECTION -->
        <div id="photos" class="section">
            <div class="card">
                <h2>Memories</h2>
                <div class="file-upload-area" onclick="document.getElementById('photoUpload').click()">
                    Click to upload photos
                </div>
                <input type="file" id="photoUpload" accept="image/*" multiple style="display:none">
                <input type="text" id="photoCaption" placeholder="Photo description (optional)">
                <button onclick="addPhotos()">Save Photos</button>
            </div>
            <div id="photoGallery" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;"></div>
        </div>
    </div>
    
    <script>
        const quotes = [
            "Long live all the magic we made ✨",
            "Shake it off, I'm just gonna shake it off 💃",
            "This is a new year, a new beginning 🌟",
            "You are what you love, not who loves you 💫",
            "It's okay to not be okay sometimes 🤍",
            "The best people in life are free 💝",
            "We never go out of style ✨",
            "Everything will be alright if we just keep dancing 💃",
            "People throw rocks at things that shine 💎",
            "This night is sparkling, don't you let it go 🌙"
        ];
        
        function setDailyQuote() {
            const today = new Date().toDateString();
            let quoteIndex = Number(today.split('').reduce((a,b) => a + b.charCodeAt(0), 0)) % quotes.length;
            document.getElementById('dailyQuote').textContent = quotes[quoteIndex];
        }
        
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const isDark = document.body.classList.contains('dark-mode');
            document.querySelector('.mode-toggle').textContent = isDark ? '☀️' : '🌙';
        }
        
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');
            
            if (sectionId === 'home') updateStats();
        }
        
        function getTodayKey() {
            return new Date().toLocaleDateString('en-US');
        }
        
        // JOURNAL FUNCTIONS
        function addJournalNote() {
            const text = document.getElementById('journalText').value.trim();
            if (!text) return alert('Write something first');
            
            const data = JSON.parse(localStorage.getItem('journal') || '{}');
            const today = getTodayKey();
            
            if (!data[today]) data[today] = [];
            
            data[today].push({
                id: Date.now(),
                text: text,
                time: new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })
            });
            
            localStorage.setItem('journal', JSON.stringify(data));
            document.getElementById('journalText').value = '';
            loadJournal();
            updateStats();
        }
        
        function loadJournal() {
            const data = JSON.parse(localStorage.getItem('journal') || '{}');
            const container = document.getElementById('journalDays');
            const days = Object.keys(data).sort().reverse();
            
            container.innerHTML = days.map(day => `
                <div class="day-section">
                    <div class="day-header">
                        <span>${day}</span>
                        <button class="delete-btn" onclick="deleteDay('${day}')">Delete Day</button>
                    </div>
                    ${data[day].map(note => `
                        <div class="note-item">
                            <div class="note-time">${note.time}</div>
                            <div>${note.text}</div>
                            <button style="margin-top: 12px; padding: 10px 25px;" class="delete-btn" onclick="deleteNote('${day}', ${note.id})">Delete</button>
                        </div>
                    `).join('')}
                </div>
            `).join('');
        }
        
        function deleteNote(day, id) {
            const data = JSON.parse(localStorage.getItem('journal') || '{}');
            data[day] = data[day].filter(n => n.id !== id);
            if (data[day].length === 0) delete data[day];
            localStorage.setItem('journal', JSON.stringify(data));
            loadJournal();
        }
        
        function deleteDay(day) {
            if (!confirm('Delete all notes from this day?')) return;
            const data = JSON.parse(localStorage.getItem('journal') || '{}');
            delete data[day];
            localStorage.setItem('journal', JSON.stringify(data));
            loadJournal();
        }
        
        // SONGS FUNCTIONS
        function addSong() {
            const name = document.getElementById('songName').value.trim();
            const artist = document.getElementById('songArtist').value.trim();
            const link = document.getElementById('songLink').value.trim();
            
            if (!name) return alert('Enter song name');
            
            const songs = JSON.parse(localStorage.getItem('songs') || '[]');
            songs.push({ id: Date.now(), name, artist, link });
            localStorage.setItem('songs', JSON.stringify(songs));
            
            document.getElementById('songName').value = '';
            document.getElementById('songArtist').value = '';
            document.getElementById('songLink').value = '';
            loadSongs();
        }
        
        function loadSongs() {
            const songs = JSON.parse(localStorage.getItem('songs') || '[]');
            const container = document.getElementById('songsList');
            
            container.innerHTML = songs.map(song => `
                <div class="song-item card">
                    <div class="item-content">
                        <strong>${song.name}</strong><br>
                        ${song.artist ? `<span style="color: var(--text-light)">${song.artist}</span>` : ''}
                    </div>
                    <div class="item-actions">
                        ${song.link ? `<button onclick="window.open('${song.link}', '_blank')">Open</button>` : ''}
                        <button class="delete-btn" onclick="deleteSong(${song.id})">Delete</button>
                    </div>
                </div>
            `).join('');
        }
        
        function deleteSong(id) {
            let songs = JSON.parse(localStorage.getItem('songs') || '[]');
            songs = songs.filter(s => s.id !== id);
            localStorage.setItem('songs', JSON.stringify(songs));
            loadSongs();
        }
        
        // REMINDERS FUNCTIONS
        function addReminder() {
            const text = document.getElementById('reminderText').value.trim();
            const date = document.getElementById('reminderDate').value;
            
            if (!text) return alert('Write a reminder');
            
            const reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
            reminders.push({ id: Date.now(), text, date, completed: false });
            localStorage.setItem('reminders', JSON.stringify(reminders));
            
            document.getElementById('reminderText').value = '';
            document.getElementById('reminderDate').value = '';
            loadReminders();
        }
        
        function loadReminders() {
            const reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
            const container = document.getElementById('remindersList');
            
            container.innerHTML = reminders.map(r => `
                <div class="reminder-item ${r.completed ? 'completed' : ''}">
                    <input type="checkbox" class="checkbox" ${r.completed ? 'checked' : ''} 
                           onchange="toggleReminder(${r.id})">
                    <div class="item-content">
                        <span class="reminder-text">${r.text}</span><br>
                        ${r.date ? `<small style="color: var(--text-light)">${r.date}</small>` : ''}
                    </div>
                    <button class="delete-btn" onclick="deleteReminder(${r.id})">Delete</button>
                </div>
            `).join('');
        }
        
        function toggleReminder(id) {
            const reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
            const reminder = reminders.find(r => r.id === id);
            reminder.completed = !reminder.completed;
            localStorage.setItem('reminders', JSON.stringify(reminders));
            loadReminders();
        }
        
        function deleteReminder(id) {
            let reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
            reminders = reminders.filter(r => r.id !== id);
            localStorage.setItem('reminders', JSON.stringify(reminders));
            loadReminders();
        }
        
        // FACULTY TASKS
        let currentFiles = [];
        
        document.getElementById('taskFile').addEventListener('change', function(e) {
            currentFiles = Array.from(e.target.files);
            const filesList = document.getElementById('taskFilesList');
            filesList.innerHTML = currentFiles.map((f, i) => `
                <div class="file-item">
                    <span>${f.name}</span>
                    <button class="delete-btn" onclick="removeFile(${i})">Remove</button>
                </div>
            `).join('');
        });
        
        function removeFile(index) {
            currentFiles.splice(index, 1);
            const dt = new DataTransfer();
            currentFiles.forEach(f => dt.items.add(f));
            document.getElementById('taskFile').files = dt.files;
            document.getElementById('taskFile').dispatchEvent(new Event('change'));
        }
        
        function addTask() {
            const subject = document.getElementById('taskSubject').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const date = document.getElementById('taskDate').value;
            const priority = document.getElementById('taskPriority').value;
            
            if (!subject || !description) return alert('Complete subject and description');
            
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            
            const filePromises = Array.from(currentFiles).map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve({
                        name: file.name,
                        type: file.type,
                        data: e.target.result
                    });
                    reader.readAsDataURL(file);
                });
            });
            
            Promise.all(filePromises).then(files => {
                tasks.push({
                    id: Date.now(),
                    subject,
                    description,
                    date,
                    priority,
                    files,
                    completed: false
                });
                
                localStorage.setItem('tasks', JSON.stringify(tasks));
                document.getElementById('taskSubject').value = '';
                document.getElementById('taskDescription').value = '';
                document.getElementById('taskDate').value = '';
                document.getElementById('taskFile').value = '';
                document.getElementById('taskFilesList').innerHTML = '';
                currentFiles = [];
                loadTasks();
                updateStats();
            });
        }
        
        function loadTasks() {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const container = document.getElementById('tasksList');
            
            const priorityColors = {
                'baja': '#90c090',
                'media': '#d4a574',
                'alta': '#c07070'
            };
            
            container.innerHTML = tasks.map(task => `
                <div class="task-item card ${task.completed ? 'completed' : ''}">
                    <input type="checkbox" class="checkbox" ${task.completed ? 'checked' : ''} 
                           onchange="toggleTask(${task.id})">
                    <div class="item-content">
                        <strong class="task-text" style="color: ${priorityColors[task.priority]}">${task.subject}</strong><br>
                        <span class="task-text">${task.description}</span><br>
                        ${task.date ? `<small style="color: var(--text-light)">${task.date}</small>` : ''}
                        ${task.files.length > 0 ? `<div style="margin-top: 12px;">
                            ${task.files.map(f => `
                                <div class="file-item">
                                    <span>${f.name}</span>
                                    <button onclick="downloadFile('${f.name}', '${f.data}')">Download</button>
                                </div>
                            `).join('')}
                        </div>` : ''}
                    </div>
                    <button class="delete-btn" onclick="deleteTask(${task.id})">Delete</button>
                </div>
            `).join('');
        }
        
        function toggleTask(id) {
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const task = tasks.find(t => t.id === id);
            task.completed = !task.completed;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
            updateStats();
        }
        
        function deleteTask(id) {
            let tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            tasks = tasks.filter(t => t.id !== id);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
            updateStats();
        }
        
        function downloadFile(filename, dataUrl) {
            const a = document.createElement('a');
            a.href = dataUrl;
            a.download = filename;
            a.click();
        }
        
        // GOALS FUNCTIONS
        function addGoal() {
            const title = document.getElementById('goalTitle').value.trim();
            const description = document.getElementById('goalDescription').value.trim();
            const deadline = document.getElementById('goalDeadline').value;
            
            if (!title) return alert('Enter goal title');
            
            const goals = JSON.parse(localStorage.getItem('goals') || '[]');
            goals.push({
                id: Date.now(),
                title,
                description,
                deadline,
                progress: 0
            });
            
            localStorage.setItem('goals', JSON.stringify(goals));
            document.getElementById('goalTitle').value = '';
            document.getElementById('goalDescription').value = '';
            document.getElementById('goalDeadline').value = '';
            loadGoals();
            updateStats();
        }
        
        function loadGoals() {
            const goals = JSON.parse(localStorage.getItem('goals') || '[]');
            const container = document.getElementById('goalsList');
            
            container.innerHTML = goals.map(goal => `
                <div class="goal-card">
                    <h3>${goal.title}</h3>
                    <p style="color: var(--text-light); font-size: 0.9em;">${goal.description}</p>
                    ${goal.deadline ? `<p style="color: var(--text-light); font-size: 0.85em; margin-top: 10px;">${goal.deadline}</p>` : ''}
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${goal.progress}%"></div>
                    </div>
                    <p style="text-align: center; margin: 12px 0; font-size: 0.9em;">${goal.progress}% complete</p>
                    <input type="range" min="0" max="100" value="${goal.progress}" 
                           onchange="updateGoalProgress(${goal.id}, this.value)"
                           style="width: 100%; cursor: pointer;">
                    <button class="delete-btn" onclick="deleteGoal(${goal.id})" style="width: 100%; margin-top: 12px;">Delete Goal</button>
                </div>
            `).join('');
        }
        
        function updateGoalProgress(id, progress) {
            const goals = JSON.parse(localStorage.getItem('goals') || '[]');
            const goal = goals.find(g => g.id === id);
            goal.progress = parseInt(progress);
            localStorage.setItem('goals', JSON.stringify(goals));
            loadGoals();
        }
        
        function deleteGoal(id) {
            let goals = JSON.parse(localStorage.getItem('goals') || '[]');
            goals = goals.filter(g => g.id !== id);
            localStorage.setItem('goals', JSON.stringify(goals));
            loadGoals();
            updateStats();
        }
        
        // PHOTOS FUNCTIONS
        document.getElementById('photoUpload').addEventListener('change', function() {
            const caption = document.getElementById('photoCaption').value.trim();
            if (this.files.length > 0) {
                document.querySelector('#photos button').textContent = 'Save ' + this.files.length + ' photo(s)';
            }
        });
        
        function addPhotos() {
            const files = document.getElementById('photoUpload').files;
            const caption = document.getElementById('photoCaption').value.trim();
            
            if (files.length === 0) return alert('Select at least one photo');
            
            const photos = JSON.parse(localStorage.getItem('photos') || '[]');
            
            const filePromises = Array.from(files).map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = (e) => resolve({
                        id: Date.now() + Math.random(),
                        data: e.target.result,
                        caption: caption,
                        date: getTodayKey()
                    });
                    reader.readAsDataURL(file);
                });
            });
            
            Promise.all(filePromises).then(newPhotos => {
                photos.push(...newPhotos);
                localStorage.setItem('photos', JSON.stringify(photos));
                document.getElementById('photoUpload').value = '';
                document.getElementById('photoCaption').value = '';
                document.querySelector('#photos button').textContent = 'Save Photos';
                loadPhotos();
            });
        }
        
        function loadPhotos() {
            const photos = JSON.parse(localStorage.getItem('photos') || '[]');
            const container = document.getElementById('photoGallery');
            
            container.innerHTML = photos.map(photo => `
                <div class="card" style="padding: 12px;">
                    <img src="${photo.data}" style="width: 100%; height: 200px; object-fit: cover;">
                    ${photo.caption ? `<p style="margin-top: 12px; font-size: 0.85em; color: var(--text-light);">${photo.caption}</p>` : ''}
                    <small style="color: var(--text-light); font-size: 0.75em;">${photo.date}</small>
                    <button class="delete-btn" onclick="deletePhoto(${photo.id})" style="width: 100%; margin-top: 10px;">Delete</button>
                </div>
            `).join('');
        }
        
        function deletePhoto(id) {
            let photos = JSON.parse(localStorage.getItem('photos') || '[]');
            photos = photos.filter(p => p.id !== id);
            localStorage.setItem('photos', JSON.stringify(photos));
            loadPhotos();
        }
        
        // MOOD TRACKING
        function saveMood(emoji) {
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            const today = getTodayKey();
            moods[today] = emoji;
            localStorage.setItem('moods', JSON.stringify(moods));
            
            document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            
            loadMoodHistory();
        }
        
        function loadMoodHistory() {
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            const container = document.getElementById('moodHistory');
            const days = Object.keys(moods).sort().reverse().slice(0, 7);
            
            if (days.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: var(--text-light); font-size: 0.9em;">No mood recorded yet</p>';
                return;
            }
            
            container.innerHTML = '<h3>Last Week</h3>' + days.map(day => `
                <div style="display: flex; justify-content: space-between; padding: 12px; background: var(--cream); margin: 8px 0; font-size: 0.9em;">
                    <span style="color: var(--text-light);">${day}</span>
                    <span style="font-size: 1.4em;">${moods[day]}</span>
                </div>
            `).join('');
        }
        
        // STATS
        function updateStats() {
            const journal = JSON.parse(localStorage.getItem('journal') || '{}');
            const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
            const goals = JSON.parse(localStorage.getItem('goals') || '[]');
            
            const today = getTodayKey();
            const todayNotes = journal[today] ? journal[today].length : 0;
            const pendingTasks = tasks.filter(t => !t.completed).length;
            const activeGoals = goals.length;
            const totalDays = Object.keys(journal).length;
            
            document.getElementById('statNotes').textContent = todayNotes;
            document.getElementById('statTasks').textContent = pendingTasks;
            document.getElementById('statGoals').textContent = activeGoals;
            document.getElementById('statDays').textContent = totalDays;
        }
        
        // INIT
        window.onload = function() {
            setDailyQuote();
            document.getElementById('todayDate').textContent = new Date().toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            loadJournal();
            loadSongs();
            loadReminders();
            loadTasks();
            loadGoals();
            loadPhotos();
            loadMoodHistory();
            updateStats();
            
            const today = getTodayKey();
            const moods = JSON.parse(localStorage.getItem('moods') || '{}');
            if (moods[today]) {
                document.querySelectorAll('.mood-btn').forEach(btn => {
                    if (btn.textContent.includes(moods[today])) {
                        btn.classList.add('selected');
                    }
                });
            }
        };
    </script>
</body>
</html>